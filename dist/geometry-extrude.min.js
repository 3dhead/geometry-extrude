!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.geometryExtrude={})}(this,function(t){"use strict";var e=r,n=r;function r(t,e,n){n=n||2;var r,s,u,h,x,a,p,y=e&&e.length,g=y?e[0]*n:t.length,d=o(t,0,g,n,!0),b=[];if(!d)return b;if(y&&(d=function(t,e,n,r){var l,s,u,h,x,a=[];for(l=0,s=e.length;l<s;l++)u=e[l]*r,h=l<s-1?e[l+1]*r:t.length,(x=o(t,u,h,r,!1))===x.next&&(x.steiner=!0),a.push(v(x));for(a.sort(c),l=0;l<a.length;l++)f(a[l],n),n=i(n,n.next);return n}(t,e,d,n)),t.length>80*n){r=u=t[0],s=h=t[1];for(var m=n;m<g;m+=n)x=t[m],a=t[m+1],x<r&&(r=x),a<s&&(s=a),x>u&&(u=x),a>h&&(h=a);p=0!==(p=Math.max(u-r,h-s))?1/p:0}return l(d,b,n,r,s,p),b}function o(t,e,n,r,o){var i,l;if(o===z(t,e,n,r)>0)for(i=e;i<n;i+=r)l=w(i,t[i],t[i+1],l);else for(i=n-r;i>=e;i-=r)l=w(i,t[i],t[i+1],l);return l&&d(l,l.next)&&(S(l),l=l.next),l}function i(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!d(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function l(t,e,n,r,o,c,f){if(t){!f&&c&&function(t,e,n,r){var o=t;do{null===o.z&&(o.z=a(o.x,o.y,e,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,r,o,i,l,s,u,h=1;do{for(n=t,t=null,i=null,l=0;n;){for(l++,r=n,s=0,e=0;e<h&&(s++,r=r.nextZ);e++);for(u=h;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(o=n,n=n.nextZ,s--):(o=r,r=r.nextZ,u--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;n=r}i.nextZ=null,h*=2}while(l>1)}(o)}(t,r,o,c);for(var v,p,y=t;t.prev!==t.next;)if(v=t.prev,p=t.next,c?u(t,r,o,c):s(t))e.push(v.i/n),e.push(t.i/n),e.push(p.i/n),S(t),t=p.next,y=p.next;else if((t=p)===y){f?1===f?l(t=h(t,e,n),e,n,r,o,c,2):2===f&&x(t,e,n,r,o,c):l(i(t),e,n,r,o,c,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(p(e.x,e.y,n.x,n.y,r.x,r.y,o.x,o.y)&&g(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function u(t,e,n,r){var o=t.prev,i=t,l=t.next;if(g(o,i,l)>=0)return!1;for(var s=o.x<i.x?o.x<l.x?o.x:l.x:i.x<l.x?i.x:l.x,u=o.y<i.y?o.y<l.y?o.y:l.y:i.y<l.y?i.y:l.y,h=o.x>i.x?o.x>l.x?o.x:l.x:i.x>l.x?i.x:l.x,x=o.y>i.y?o.y>l.y?o.y:l.y:i.y>l.y?i.y:l.y,c=a(s,u,e,n,r),f=a(h,x,e,n,r),v=t.prevZ,y=t.nextZ;v&&v.z>=c&&y&&y.z<=f;){if(v!==t.prev&&v!==t.next&&p(o.x,o.y,i.x,i.y,l.x,l.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,y!==t.prev&&y!==t.next&&p(o.x,o.y,i.x,i.y,l.x,l.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;v&&v.z>=c;){if(v!==t.prev&&v!==t.next&&p(o.x,o.y,i.x,i.y,l.x,l.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=f;){if(y!==t.prev&&y!==t.next&&p(o.x,o.y,i.x,i.y,l.x,l.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function h(t,e,n){var r=t;do{var o=r.prev,i=r.next.next;!d(o,i)&&b(o,r,r.next,i)&&m(o,i)&&m(i,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(i.i/n),S(r),S(r.next),r=t=i),r=r.next}while(r!==t);return r}function x(t,e,n,r,o,s){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&y(u,h)){var x=M(u,h);return u=i(u,u.next),x=i(x,x.next),l(u,e,n,r,o,s),void l(x,e,n,r,o,s)}h=h.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,r=e,o=t.x,i=t.y,l=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=o&&s>l){if(l=s,s===o){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(o===l)return n.prev;var u,h=n,x=n.x,c=n.y,f=1/0;r=n.next;for(;r!==h;)o>=r.x&&r.x>=x&&o!==r.x&&p(i<c?o:l,i,x,c,i<c?l:o,i,r.x,r.y)&&((u=Math.abs(i-r.y)/(o-r.x))<f||u===f&&r.x>n.x)&&m(r,t)&&(n=r,f=u),r=r.next;return n}(t,e)){var n=M(e,t);i(n,n.next)}}function a(t,e,n,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,o,i,l,s){return(o-l)*(e-s)-(t-l)*(i-s)>=0&&(t-l)*(r-s)-(n-l)*(e-s)>=0&&(n-l)*(i-s)-(o-l)*(r-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&m(t,e)&&m(e,t)&&function(t,e){var n=t,r=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function d(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){return!!(d(t,e)&&d(n,r)||d(t,r)&&d(n,e))||g(t,e,n)>0!=g(t,e,r)>0&&g(n,r,t)>0!=g(n,r,e)>0}function m(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function M(t,e){var n=new Z(t.i,t.x,t.y),r=new Z(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function w(t,e,n,r){var o=new Z(t,e,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Z(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function z(t,e,n,r){for(var o=0,i=e,l=n-r;i<n;i+=r)o+=(t[l]-t[i])*(t[i+1]+t[l+1]),l=i;return o}function R(t,e){return t[0]*e[0]+t[1]*e[1]}function A(t,e){const n=e[0],r=e[1],o=Math.sqrt(n*n+r*r);return t[0]=n/o,t[1]=r/o,t}function q(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function B(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function O(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function P(t,e){const n=e[0],r=e[1],o=e[2],i=Math.sqrt(n*n+r*r+o*o);return t[0]=n/i,t[1]=r/i,t[2]=o/i,t}r.deviation=function(t,e,n,r){var o=e&&e.length,i=o?e[0]*n:t.length,l=Math.abs(z(t,0,i,n));if(o)for(var s=0,u=e.length;s<u;s++){var h=e[s]*n,x=s<u-1?e[s+1]*n:t.length;l-=Math.abs(z(t,h,x,n))}var c=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,a=r[s+1]*n,v=r[s+2]*n;c+=Math.abs((t[f]-t[v])*(t[a+1]-t[f+1])-(t[f]-t[a])*(t[v+1]-t[f+1]))}return 0===l&&0===c?0:Math.abs((c-l)/l)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var l=0;l<e;l++)n.vertices.push(t[o][i][l]);o>0&&(r+=t[o-1].length,n.holes.push(r))}return n},e.default=n;const j=[];function F(t,e,n,r){const o=(l=n,(i=e)[0]*l[0]+i[1]*l[1]+i[2]*l[2]);var i,l;const s=Math.acos(o)*r;return q(j,n,e,-o),function(t,e){const n=e[0],r=e[1],o=e[2],i=Math.sqrt(n*n+r*r+o*o);t[0]=n/i,t[1]=r/i,t[2]=o/i}(j,j),function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}(t,e,Math.cos(s)),q(t,t,j,Math.sin(s)),t}function k(t,e,n){if(n-e<3)return 0;let r=0;for(let o=2*(n-1),i=2*e;i<2*n;){const e=t[o],n=t[o+1],l=t[i],s=t[i+1];o=i,i+=2,r+=e*s-l*n}return r}function L(t,n,r=2){return e(t,n,r)}const U=[],V=[],W=[];function E(t,e,n,r,o,i,l,s){const u=null!=l;let h=o,x=null;u&&(x=new Uint32Array(r-n));for(let o=n;o<r;o++){const c=o===r-1?n:o+1,f=o===n?r-1:o-1,a=t[2*f],v=t[2*f+1],p=t[2*o],y=t[2*o+1],g=t[2*c],d=t[2*c+1];if(U[0]=p-a,U[1]=y-v,V[0]=g-p,V[1]=d-y,A(U,U),A(V,V),u&&(x[o]=h),s||o!==n)if(s||o!==r-1){B(W,V,U);const t=W[1];W[1]=-W[0],W[0]=t,A(W,W);const n=R(W,V),r=Math.sqrt(1-n*n),o=i*Math.min(10,1/r);if(u&&1/r>l&&i*n<0){const t=p+W[0]*i,n=y+W[1]*i,o=Math.acos(r)/2,l=Math.tan(o)*Math.abs(i);e[2*h]=t+W[1]*l,e[2*h+1]=n-W[0]*l,e[2*++h]=t-W[1]*l,e[2*h+1]=n+W[0]*l,h++}else e[2*h]=p+W[0]*o,e[2*h+1]=y+W[1]*o,h++}else W[0]=U[1],W[1]=-U[0],A(W,W),e[2*h]=p+W[0]*i,e[2*h+1]=y+W[1]*i,h++;else W[0]=V[1],W[1]=-V[0],A(W,W),e[2*h]=p+W[0]*i,e[2*h+1]=y+W[1]*i,h++}return x}function I(t,e,n,r,o){const i=null!=r?[]:new Float32Array(t.length);if(E(t,i,0,e&&e.length?e[0]:t.length/2,0,n,r,o),e)for(let l=0;l<e.length;l++){const s=e[l];E(t,i,s,e[l+1]||t.length/2,null!=r?i.length/2:s,n,r,o)}return i}function _(t,e,n,r){for(let o=0;o<Math.floor((r-n)/2);o++)for(let i=0;i<e;i++){const l=(o+n)*e+i,s=(r-o-1)*e+i,u=t[l];t[l]=t[s],t[s]=u}return t}function D(t,e){let n=t.length/2,r=0,o=e&&e.length?e[0]:n;k(t,r,o)>0&&_(t,2,r,o);for(let i=1;i<(e?e.length:0)+1;i++)k(t,r=e[i-1],o=e[i]||n)<0&&_(t,2,r,o)}function G(t){t.depth=t.depth||1,t.bevelSize=t.bevelSize||0,t.bevelSegments=null==t.bevelSegments?2:t.bevelSegments,t.smoothSide=t.smoothSide||!1,t.smoothBevel=t.smoothBevel||!1,"number"==typeof t.depth&&(t.bevelSize=Math.min(t.bevelSegments>0?t.bevelSize:0,t.depth/2)),t.bevelSize>0||(t.bevelSegments=0),t.bevelSegments=Math.round(t.bevelSegments);const e=t.boundingRect;if(t.translate=t.translate||[0,0],t.scale=t.scale||[1,1],t.fitRect){let n=null==t.fitRect.x?e.x||0:t.fitRect.x,r=null==t.fitRect.y?e.y||0:t.fitRect.y,o=t.fitRect.width,i=t.fitRect.height;null==o?null!=i?o=i/e.height*e.width:(o=e.width,i=e.height):null==i&&(i=o/e.width*e.height),t.scale=[o/e.width,i/e.height],t.translate=[(n-e.x)*t.scale[0],(r-e.y)*t.scale[1]]}}const J=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function N(t,{vertices:e,topVertices:n,depth:r,rect:o},i,l,s,u){const h=l-i,x=u.smoothSide?1:2,c=h*x,f=u.smoothBevel?1:2,a=Math.min(r/2,u.bevelSize),v=u.bevelSegments,p=s.vertex,y=Math.max(o.width,o.height);if(a>0){const o=[0,0,1],l=[],u=[0,0,-1],g=[];let d=0,b=new Float32Array(h);for(let m=0;m<2;m++){const M=0===m?r-a:a;for(let r=0;r<=v*f;r++){let w,S,Z=0;for(let z=0;z<h;z++){for(let p=0;p<x;p++){let x=2*((z+p)%h+i);l[0]=e[x]-n[x],l[1]=e[x+1]-n[x+1],l[2]=0;const d=Math.sqrt(l[0]*l[0]+l[1]*l[1]);l[0]/=d,l[1]/=d;const R=(Math.floor(r/f)+r%f)/v;0===m?F(g,o,l,R):F(g,l,u,R);const A=0===m?R:1-R,q=a*Math.sin(A*Math.PI/2),B=d*Math.cos(A*Math.PI/2),O=a*d/Math.sqrt(q*q+B*B),P=g[0]*O+n[x],j=g[1]*O+n[x+1],k=g[2]*O+M;if(t.position[3*s.vertex]=P,t.position[3*s.vertex+1]=j,t.position[3*s.vertex+2]=k,(z>0||p>0)&&(Z+=Math.sqrt((w-P)*(w-P)+(S-j)*(S-j))),r>0||m>0){let e=3*(s.vertex-c),n=t.position[e],r=t.position[e+1],o=t.position[e+2];b[z]+=Math.sqrt((n-P)*(n-P)+(r-j)*(r-j)+(o-k)*(o-k))}t.uv[2*s.vertex]=Z/y,t.uv[2*s.vertex+1]=b[z]/y,w=P,S=j,s.vertex++}if(f>1&&r%f||1===f&&r>=1)for(let e=0;e<6;e++){const n=(J[e][0]+z*x)%c,r=J[e][1]+d;t.indices[s.index++]=(r-1)*c+n+p}}d++}}}else for(let n=0;n<2;n++){const o=0===n?r-a:a;let l,u,c=0;for(let n=0;n<h;n++)for(let r=0;r<x;r++){const x=2*((n+r)%h+i),f=e[x],a=e[x+1];t.position[3*s.vertex]=f,t.position[3*s.vertex+1]=a,t.position[3*s.vertex+2]=o,(n>0||r>0)&&(c+=Math.sqrt((l-f)*(l-f)+(u-a)*(u-a))),t.uv[2*s.vertex]=c/y,t.uv[2*s.vertex+1]=o/y,l=f,u=a,s.vertex++}}const g=a>0?v*f+1:1;for(let e=0;e<h;e++)for(let n=0;n<6;n++){const r=(J[n][0]+e*x)%c,o=J[n][1]+g;t.indices[s.index++]=(o-1)*c+r+p}}function C({indices:t,vertices:e,topVertices:n,rect:r,depth:o},i,l,s){if(e.length<=4)return;const u=l.vertex,h=t.length;for(let e=0;e<h;e++)i.indices[l.index++]=u+t[e];const x=Math.max(r.width,r.height);for(let t=0;t<(s.excludeBottom?1:2);t++)for(let e=0;e<n.length;e+=2){const s=n[e],u=n[e+1];i.position[3*l.vertex]=s,i.position[3*l.vertex+1]=u,i.position[3*l.vertex+2]=(1-t)*o,i.uv[2*l.vertex]=(s-r.x)/x,i.uv[2*l.vertex+1]=(u-r.y)/x,l.vertex++}if(!s.excludeBottom){const n=e.length/2;for(let e=0;e<h;e+=3)for(let r=0;r<3;r++)i.indices[l.index++]=u+n+t[e+2-r]}}function H(t,e){let n=0,r=0;for(let o=0;o<t.length;o++){const{indices:i,vertices:l,holes:s,depth:u}=t[o],h=l.length/2,x=Math.min(u/2,e.bevelSize)>0?e.bevelSegments:0;n+=i.length*(e.excludeBottom?1:2),r+=h*(e.excludeBottom?1:2);const c=2+2*x;let f=0,a=0;for(let t=0;t<(s?s.length:0)+1;t++){0===t?a=s&&s.length?s[0]:h:(f=s[t-1],a=s[t]||h),n+=6*(a-f)*(c-1);const o=(a-f)*(e.smoothSide?1:2);r+=o*c+(e.smoothBevel?0:x*o*2)}}const o={position:new Float32Array(3*r),indices:new(r>65535?Uint32Array:Uint16Array)(n),uv:new Float32Array(2*r)},i={vertex:0,index:0};for(let n=0;n<t.length;n++)C(t[n],o,i,e);for(let n=0;n<t.length;n++){const{holes:r,vertices:l}=t[n],s=l.length/2;let u=0,h=r&&r.length?r[0]:s;if(N(o,t[n],u,h,i,e),r)for(let l=0;l<r.length;l++)u=r[l],h=r[l+1]||s,N(o,t[n],u,h,i,e)}for(let t=0;t<o.uv.length;t++){const e=o.uv[t];e>0&&Math.round(e)===e?o.uv[t]=1:o.uv[t]=e%1}return o.normal=function(t,e){function n(t,e,n,r){t[0]=e,t[1]=n,t[2]=r}const r=[],o=[],i=[],l=[],s=[],u=[],h=t.length,x=new Float32Array(e.length);for(let m=0;m<h;){const h=3*t[m++],M=3*t[m++],w=3*t[m++];n(r,e[h],e[h+1],e[h+2]),n(o,e[M],e[M+1],e[M+2]),n(i,e[w],e[w+1],e[w+2]),O(l,r,o),O(s,o,i),c=u,a=s,v=(f=l)[0],p=f[1],y=f[2],g=a[0],d=a[1],b=a[2],c[0]=p*b-y*d,c[1]=y*g-v*b,c[2]=v*d-p*g;for(let t=0;t<3;t++)x[h+t]=x[h+t]+u[t],x[M+t]=x[M+t]+u[t],x[w+t]=x[w+t]+u[t]}for(var c,f,a,v,p,y,g,d,b,m=0;m<x.length;)n(u,x[m],x[m+1],x[m+2]),P(u,u),x[m++]=u[0],x[m++]=u[1],x[m++]=u[2];return x}(o.indices,o.position),o.boundingRect=t[0]&&t[0].rect,o}function K(t,e,n){const r=n.lineWidth,o=t.length,i=new Float32Array(2*o),l=n.translate||[0,0],s=n.scale||[1,1];for(let e=0,n=0;e<o;e++)i[n++]=t[e][0]*s[0]+l[0],i[n++]=t[e][1]*s[1]+l[1];k(i,0,o)<0&&_(i,2,0,o);const u=[],h=[],x=n.miterLimit,c=E(i,h,0,o,0,-r/2,x,!1);_(i,2,0,o);const f=E(i,u,0,o,0,-r/2,x,!1),a=(u.length+h.length)/2,v=new Float32Array(2*a);let p=0;const y=h.length/2;for(let t=0;t<h.length;t++)v[p++]=h[t];for(let t=0;t<u.length;t++)v[p++]=u[t];const g=new(a>65535?Uint32Array:Uint16Array)(3*(2*(o-1)+(a-2*o)));let d=0;for(let t=0;t<o-1;t++){const e=t+1;g[d++]=y-1-c[t],g[d++]=y-1-c[t]-1,g[d++]=f[t]+1+y,g[d++]=y-1-c[t],g[d++]=f[t]+1+y,g[d++]=f[t]+y,f[e]-f[t]==2?(g[d++]=f[t]+2+y,g[d++]=f[t]+1+y,g[d++]=y-c[e]-1):c[e]-c[t]==2&&(g[d++]=f[e]+y,g[d++]=y-1-(c[t]+1),g[d++]=y-1-(c[t]+2))}const b=n.bevelSize>0?I(v,[],n.bevelSize,null,!0):v,m=n.boundingRect;return{vertices:v,indices:g,topVertices:b,rect:{x:m.x*s[0]+l[0],y:m.y*s[1]+l[1],width:m.width*s[0],height:m.height*s[1]},depth:"function"==typeof n.depth?n.depth(e):n.depth,holes:[]}}function Q(t,e){const n=[];for(let r=0;r<t.length;r++){const o=t[r],i=[],l=o.length;let s=o[l-1][0],u=o[l-1][1],h=0;for(let t=0;t<l;t++){let n=o[t][0],r=o[t][1];const l=n-s,x=r-u;(h+=Math.sqrt(l*l+x*x))>e&&(i.push(o[t]),h=0),s=n,u=r}i.length>=3&&n.push(i)}return n.length>0?n:null}function T(t,n){n=Object.assign({},n);const r=[1/0,1/0],o=[-1/0,-1/0];for(let e=0;e<t.length;e++)Y(t[e][0],r,o);n.boundingRect=n.boundingRect||{x:r[0],y:r[1],width:o[0]-r[0],height:o[1]-r[1]},G(n);const i=[],l=n.translate||[0,0],s=n.scale||[1,1],u=n.boundingRect,h={x:u.x*s[0]+l[0],y:u.y*s[1]+l[1],width:u.width*s[0],height:u.height*s[1]},x=Math.min(u.width,u.height)/1e5;for(let r=0;r<t.length;r++){const o=Q(t[r],x);if(!o)continue;const{vertices:u,holes:c,dimensions:f}=e.flatten(o);for(let t=0;t<u.length;)u[t]=u[t++]*s[0]+l[0],u[t]=u[t++]*s[1]+l[1];if(D(u,c),2!==f)throw new Error("Only 2D polygon points are supported");const a=n.bevelSize>0?I(u,c,n.bevelSize,null,!0):u,v=L(a,c,f);i.push({indices:v,vertices:u,topVertices:a,holes:c,rect:h,depth:"function"==typeof n.depth?n.depth(r):n.depth})}return H(i,n)}function X(t,e){e=Object.assign({},e);const n=[1/0,1/0],r=[-1/0,-1/0];for(let e=0;e<t.length;e++)Y(t[e],n,r);e.boundingRect=e.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},G(e),null==e.lineWidth&&(e.lineWidth=1),null==e.miterLimit&&(e.miterLimit=2);const o=[];for(let n=0;n<t.length;n++)o.push(K(t[n],n,e));return H(o,e)}function Y(t,e,n){for(let r=0;r<t.length;r++)e[0]=Math.min(t[r][0],e[0]),e[1]=Math.min(t[r][1],e[1]),n[0]=Math.max(t[r][0],n[0]),n[1]=Math.max(t[r][1],n[1])}t.triangulate=L,t.flatten=function(t){return e.flatten(t)},t.offsetPolygon=I,t.extrudePolygon=T,t.extrudePolyline=X,t.extrudeGeoJSON=function(t,e){e=Object.assign({},e);const n=[],r=[],o=[],i=[],l=[1/0,1/0],s=[-1/0,-1/0];for(let e=0;e<t.features.length;e++){const u=t.features[e].geometry;if(u&&u.coordinates)switch(u.type){case"LineString":n.push(u.coordinates),o.push(e),Y(u.coordinates,l,s);break;case"MultiLineString":for(let t=0;t<u.coordinates.length;t++)n.push(u.coordinates[t]),o.push(e),Y(u.coordinates[t],l,s);break;case"Polygon":r.push(u.coordinates),i.push(e),Y(u.coordinates[0],l,s);break;case"MultiPolygon":for(let t=0;t<u.coordinates.length;t++)r.push(u.coordinates[t]),i.push(e),Y(u.coordinates[t][0],l,s)}}e.boundingRect=e.boundingRect||{x:l[0],y:l[1],width:s[0]-l[0],height:s[1]-l[1]};const u=e.depth;return{polyline:X(n,Object.assign(e,{depth:function(e){return"function"==typeof u?u(t.features[o[e]]):u}})),polygon:T(r,Object.assign(e,{depth:function(e){return"function"==typeof u?u(t.features[i[e]]):u}}))}},Object.defineProperty(t,"__esModule",{value:!0})});
