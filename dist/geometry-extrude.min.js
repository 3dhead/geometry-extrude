!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.geometryExtrude={})}(this,function(t){"use strict";var e=r,n=r;function r(t,e,n){n=n||2;var r,s,h,u,x,a,p,y=e&&e.length,g=y?e[0]*n:t.length,d=i(t,0,g,n,!0),b=[];if(!d)return b;if(y&&(d=function(t,e,n,r){var l,s,h,u,x,a=[];for(l=0,s=e.length;l<s;l++)h=e[l]*r,u=l<s-1?e[l+1]*r:t.length,(x=i(t,h,u,r,!1))===x.next&&(x.steiner=!0),a.push(v(x));for(a.sort(c),l=0;l<a.length;l++)f(a[l],n),n=o(n,n.next);return n}(t,e,d,n)),t.length>80*n){r=h=t[0],s=u=t[1];for(var M=n;M<g;M+=n)x=t[M],a=t[M+1],x<r&&(r=x),a<s&&(s=a),x>h&&(h=x),a>u&&(u=a);p=0!==(p=Math.max(h-r,u-s))?1/p:0}return l(d,b,n,r,s,p),b}function i(t,e,n,r,i){var o,l;if(i===z(t,e,n,r)>0)for(o=e;o<n;o+=r)l=w(o,t[o],t[o+1],l);else for(o=n-r;o>=e;o-=r)l=w(o,t[o],t[o+1],l);return l&&d(l,l.next)&&(S(l),l=l.next),l}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!d(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function l(t,e,n,r,i,c,f){if(t){!f&&c&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=a(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,l,s,h,u=1;do{for(n=t,t=null,o=null,l=0;n;){for(l++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(h=u;s>0||h>0&&r;)0!==s&&(0===h||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,h--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(l>1)}(i)}(t,r,i,c);for(var v,p,y=t;t.prev!==t.next;)if(v=t.prev,p=t.next,c?h(t,r,i,c):s(t))e.push(v.i/n),e.push(t.i/n),e.push(p.i/n),S(t),t=p.next,y=p.next;else if((t=p)===y){f?1===f?l(t=u(t,e,n),e,n,r,i,c,2):2===f&&x(t,e,n,r,i,c):l(o(t),e,n,r,i,c,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(p(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function h(t,e,n,r){var i=t.prev,o=t,l=t.next;if(g(i,o,l)>=0)return!1;for(var s=i.x<o.x?i.x<l.x?i.x:l.x:o.x<l.x?o.x:l.x,h=i.y<o.y?i.y<l.y?i.y:l.y:o.y<l.y?o.y:l.y,u=i.x>o.x?i.x>l.x?i.x:l.x:o.x>l.x?o.x:l.x,x=i.y>o.y?i.y>l.y?i.y:l.y:o.y>l.y?o.y:l.y,c=a(s,h,e,n,r),f=a(u,x,e,n,r),v=t.prevZ,y=t.nextZ;v&&v.z>=c&&y&&y.z<=f;){if(v!==t.prev&&v!==t.next&&p(i.x,i.y,o.x,o.y,l.x,l.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,l.x,l.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;v&&v.z>=c;){if(v!==t.prev&&v!==t.next&&p(i.x,i.y,o.x,o.y,l.x,l.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=f;){if(y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,l.x,l.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function u(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!d(i,o)&&b(i,r,r.next,o)&&M(i,o)&&M(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),S(r),S(r.next),r=t=o),r=r.next}while(r!==t);return r}function x(t,e,n,r,i,s){var h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&y(h,u)){var x=m(h,u);return h=o(h,h.next),x=o(x,x.next),l(h,e,n,r,i,s),void l(x,e,n,r,i,s)}u=u.next}h=h.next}while(h!==t)}function c(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,l=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>l){if(l=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===l)return n.prev;var h,u=n,x=n.x,c=n.y,f=1/0;r=n.next;for(;r!==u;)i>=r.x&&r.x>=x&&i!==r.x&&p(o<c?i:l,o,x,c,o<c?l:i,o,r.x,r.y)&&((h=Math.abs(o-r.y)/(i-r.x))<f||h===f&&r.x>n.x)&&M(r,t)&&(n=r,f=h),r=r.next;return n}(t,e)){var n=m(e,t);o(n,n.next)}}function a(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,i,o,l,s){return(i-l)*(e-s)-(t-l)*(o-s)>=0&&(t-l)*(r-s)-(n-l)*(e-s)>=0&&(n-l)*(o-s)-(i-l)*(r-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&M(t,e)&&M(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function d(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){return!!(d(t,e)&&d(n,r)||d(t,r)&&d(n,e))||g(t,e,n)>0!=g(t,e,r)>0&&g(n,r,t)>0!=g(n,r,e)>0}function M(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function m(t,e){var n=new Z(t.i,t.x,t.y),r=new Z(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){var i=new Z(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Z(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function z(t,e,n,r){for(var i=0,o=e,l=n-r;o<n;o+=r)i+=(t[l]-t[o])*(t[o+1]+t[l+1]),l=o;return i}function R(t,e){return t[0]*e[0]+t[1]*e[1]}function A(t,e){const n=e[0],r=e[1],i=Math.sqrt(n*n+r*r);return t[0]=n/i,t[1]=r/i,t}function q(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function O(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function P(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function j(t,e){const n=e[0],r=e[1],i=e[2],o=Math.sqrt(n*n+r*r+i*i);return t[0]=n/o,t[1]=r/o,t[2]=i/o,t}r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,l=Math.abs(z(t,0,o,n));if(i)for(var s=0,h=e.length;s<h;s++){var u=e[s]*n,x=s<h-1?e[s+1]*n:t.length;l-=Math.abs(z(t,u,x,n))}var c=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,a=r[s+1]*n,v=r[s+2]*n;c+=Math.abs((t[f]-t[v])*(t[a+1]-t[f+1])-(t[f]-t[a])*(t[v+1]-t[f+1]))}return 0===l&&0===c?0:Math.abs((c-l)/l)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var l=0;l<e;l++)n.vertices.push(t[i][o][l]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n},e.default=n;const F=[];function k(t,e,n,r){const i=(l=n,(o=e)[0]*l[0]+o[1]*l[1]+o[2]*l[2]);var o,l;const s=Math.acos(i)*r;return q(F,n,e,-i),function(t,e){const n=e[0],r=e[1],i=e[2],o=Math.sqrt(n*n+r*r+i*i);t[0]=n/o,t[1]=r/o,t[2]=i/o}(F,F),function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}(t,e,Math.cos(s)),q(t,t,F,Math.sin(s)),t}function L(t,e,n){if(n-e<3)return 0;let r=0;for(let i=2*(n-1),o=2*e;o<2*n;){const e=t[i],n=t[i+1],l=t[o],s=t[o+1];i=o,o+=2,r+=e*s-l*n}return r}function U(t,n,r=2){return e(t,n,r)}const B=[],V=[],W=[];function E(t,e,n,r,i,o,l,s){const h=null!=l;let u=i,x=null;h&&(x=new Uint32Array(r-n));for(let i=n;i<r;i++){const c=i===r-1?n:i+1,f=i===n?r-1:i-1,a=t[2*f],v=t[2*f+1],p=t[2*i],y=t[2*i+1],g=t[2*c],d=t[2*c+1];if(B[0]=p-a,B[1]=y-v,V[0]=g-p,V[1]=d-y,A(B,B),A(V,V),h&&(x[i]=u),s||i!==n)if(s||i!==r-1){O(W,V,B);const t=W[1];W[1]=-W[0],W[0]=t,A(W,W);const n=R(W,V),r=Math.sqrt(1-n*n),i=o*Math.min(10,1/r);if(h&&1/r>l&&o*n<0){const t=p+W[0]*o,n=y+W[1]*o,i=Math.acos(r)/2,l=Math.tan(i)*Math.abs(o);e[2*u]=t+W[1]*l,e[2*u+1]=n-W[0]*l,e[2*++u]=t-W[1]*l,e[2*u+1]=n+W[0]*l,u++}else e[2*u]=p+W[0]*i,e[2*u+1]=y+W[1]*i,u++}else W[0]=B[1],W[1]=-B[0],A(W,W),e[2*u]=p+W[0]*o,e[2*u+1]=y+W[1]*o,u++;else W[0]=V[1],W[1]=-V[0],A(W,W),e[2*u]=p+W[0]*o,e[2*u+1]=y+W[1]*o,u++}return x}function I(t,e,n,r,i){const o=null!=r?[]:new Float32Array(t.length);if(E(t,o,0,e&&e.length?e[0]:t.length/2,0,n,r,i),e)for(let l=0;l<e.length;l++){const s=e[l];E(t,o,s,e[l+1]||t.length/2,null!=r?o.length/2:s,n,r,i)}return o}function _(t,e,n,r){for(let i=0;i<Math.floor((r-n)/2);i++)for(let o=0;o<e;o++){const l=(i+n)*e+o,s=(r-i-1)*e+o,h=t[l];t[l]=t[s],t[s]=h}return t}function D(t,e){let n=t.length/2,r=0,i=e&&e.length?e[0]:n;L(t,r,i)>0&&_(t,2,r,i);for(let o=1;o<(e?e.length:0)+1;o++)L(t,r=e[o-1],i=e[o]||n)<0&&_(t,2,r,i)}function G(t){t.depth=t.depth||1,t.bevelSize=t.bevelSize||0,t.bevelSegments=null==t.bevelSegments?2:t.bevelSegments,t.smoothSide=t.smoothSide||!1,t.smoothBevel=t.smoothBevel||!1,"number"==typeof t.depth&&(t.bevelSize=Math.min(t.bevelSegments>0?t.bevelSize:0,t.depth/2)),t.bevelSize>0||(t.bevelSegments=0),t.bevelSegments=Math.round(t.bevelSegments);const e=t.boundingRect;if(t.translate=t.translate||[0,0],t.scale=t.scale||[1,1],t.fitRect){let n=null==t.fitRect.x?e.x||0:t.fitRect.x,r=null==t.fitRect.y?e.y||0:t.fitRect.y,i=t.fitRect.width,o=t.fitRect.height;null==i?null!=o?i=o/e.height*e.width:(i=e.width,o=e.height):null==o&&(o=i/e.width*e.height),t.scale=[i/e.width,o/e.height],t.translate=[(n-e.x)*t.scale[0],(r-e.y)*t.scale[1]]}}const J=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function N(t,{vertices:e,topVertices:n,depth:r,rect:i},o,l,s,h){const u=l-o,x=h.smoothSide?1:2,c=u*x,f=h.smoothBevel?1:2,a=Math.min(r/2,h.bevelSize),v=h.bevelSegments,p=s.vertex,y=Math.max(i.width,i.height);if(a>0){const i=[0,0,1],l=[],h=[0,0,-1],g=[];let d=0,b=new Float32Array(u);for(let M=0;M<2;M++){const m=0===M?r-a:a;for(let r=0;r<=v*f;r++){let w,S,Z=0;for(let z=0;z<u;z++){for(let p=0;p<x;p++){let x=2*((z+p)%u+o);l[0]=e[x]-n[x],l[1]=e[x+1]-n[x+1],l[2]=0;const d=Math.sqrt(l[0]*l[0]+l[1]*l[1]);l[0]/=d,l[1]/=d;const R=(Math.floor(r/f)+r%f)/v;0===M?k(g,i,l,R):k(g,l,h,R);const A=0===M?R:1-R,q=a*Math.sin(A*Math.PI/2),O=d*Math.cos(A*Math.PI/2),P=a*d/Math.sqrt(q*q+O*O),j=g[0]*P+n[x],F=g[1]*P+n[x+1],L=g[2]*P+m;if(t.position[3*s.vertex]=j,t.position[3*s.vertex+1]=F,t.position[3*s.vertex+2]=L,(z>0||p>0)&&(Z+=Math.sqrt((w-j)*(w-j)+(S-F)*(S-F))),r>0||M>0){let e=3*(s.vertex-c),n=t.position[e],r=t.position[e+1],i=t.position[e+2];b[z]+=Math.sqrt((n-j)*(n-j)+(r-F)*(r-F)+(i-L)*(i-L))}t.uv[2*s.vertex]=Z/y,t.uv[2*s.vertex+1]=b[z]/y,w=j,S=F,s.vertex++}if(f>1&&r%f||1===f&&r>=1)for(let e=0;e<6;e++){const n=(J[e][0]+z*x)%c,r=J[e][1]+d;t.indices[s.index++]=(r-1)*c+n+p}}d++}}}else for(let n=0;n<2;n++){const i=0===n?r-a:a;let l,h,c=0;for(let n=0;n<u;n++)for(let r=0;r<x;r++){const x=2*((n+r)%u+o),f=e[x],a=e[x+1];t.position[3*s.vertex]=f,t.position[3*s.vertex+1]=a,t.position[3*s.vertex+2]=i,(n>0||r>0)&&(c+=Math.sqrt((l-f)*(l-f)+(h-a)*(h-a))),t.uv[2*s.vertex]=c/y,t.uv[2*s.vertex+1]=i/y,l=f,h=a,s.vertex++}}const g=a>0?v*f+1:1;for(let e=0;e<u;e++)for(let n=0;n<6;n++){const r=(J[n][0]+e*x)%c,i=J[n][1]+g;t.indices[s.index++]=(i-1)*c+r+p}}function C({indices:t,vertices:e,topVertices:n,rect:r,depth:i},o,l,s){if(e.length<=4)return;const h=l.vertex,u=t.length;for(let e=0;e<u;e++)o.indices[l.index++]=h+t[e];const x=Math.max(r.width,r.height);for(let t=0;t<2;t++)for(let e=0;e<n.length;e+=2){const s=n[e],h=n[e+1];o.position[3*l.vertex]=s,o.position[3*l.vertex+1]=h,o.position[3*l.vertex+2]=(1-t)*i,o.uv[2*l.vertex]=(s-r.x)/x,o.uv[2*l.vertex+1]=(h-r.y)/x,l.vertex++}const c=e.length/2;for(let e=0;e<u;e+=3)for(let n=0;n<3;n++)o.indices[l.index++]=h+c+t[e+2-n]}function H(t,e){let n=0,r=0;for(let i=0;i<t.length;i++){const{indices:o,vertices:l,holes:s,depth:h}=t[i],u=l.length/2,x=Math.min(h/2,e.bevelSize)>0?e.bevelSegments:0;n+=2*o.length,r+=2*u;const c=2+2*x;let f=0,a=0;for(let t=0;t<(s?s.length:0)+1;t++){0===t?a=s&&s.length?s[0]:u:(f=s[t-1],a=s[t]||u),n+=6*(a-f)*(c-1);const i=(a-f)*(e.smoothSide?1:2);r+=i*c+(e.smoothBevel?0:x*i*2)}}const i={position:new Float32Array(3*r),indices:new(r>65535?Uint32Array:Uint16Array)(n),uv:new Float32Array(2*r)},o={vertex:0,index:0};for(let e=0;e<t.length;e++)C(t[e],i,o);for(let n=0;n<t.length;n++){const{holes:r,vertices:l}=t[n],s=l.length/2;let h=0,u=r&&r.length?r[0]:s;if(N(i,t[n],h,u,o,e),r)for(let l=0;l<r.length;l++)h=r[l],u=r[l+1]||s,N(i,t[n],h,u,o,e)}for(let t=0;t<i.uv.length;t++){const e=i.uv[t];e>0&&Math.round(e)===e?i.uv[t]=1:i.uv[t]=e%1}return i.normal=function(t,e){function n(t,e,n,r){t[0]=e,t[1]=n,t[2]=r}const r=[],i=[],o=[],l=[],s=[],h=[],u=t.length,x=new Float32Array(e.length);for(let M=0;M<u;){const u=3*t[M++],m=3*t[M++],w=3*t[M++];n(r,e[u],e[u+1],e[u+2]),n(i,e[m],e[m+1],e[m+2]),n(o,e[w],e[w+1],e[w+2]),P(l,r,i),P(s,i,o),c=h,a=s,v=(f=l)[0],p=f[1],y=f[2],g=a[0],d=a[1],b=a[2],c[0]=p*b-y*d,c[1]=y*g-v*b,c[2]=v*d-p*g;for(let t=0;t<3;t++)x[u+t]=x[u+t]+h[t],x[m+t]=x[m+t]+h[t],x[w+t]=x[w+t]+h[t]}for(var c,f,a,v,p,y,g,d,b,M=0;M<x.length;)n(h,x[M],x[M+1],x[M+2]),j(h,h),x[M++]=h[0],x[M++]=h[1],x[M++]=h[2];return x}(i.indices,i.position),i.boundingRect=t[0]&&t[0].rect,i}function K(t,e,n){const r=n.lineWidth,i=t.length,o=new Float32Array(2*i),l=n.translate||[0,0],s=n.scale||[1,1];for(let e=0,n=0;e<i;e++)o[n++]=t[e][0]*s[0]+l[0],o[n++]=t[e][1]*s[1]+l[1];L(o,0,i)<0&&_(o,2,0,i);const h=[],u=[],x=n.miterLimit,c=E(o,u,0,i,0,-r/2,x,!1);_(o,2,0,i);const f=E(o,h,0,i,0,-r/2,x,!1),a=(h.length+u.length)/2,v=new Float32Array(2*a);let p=0;const y=u.length/2;for(let t=0;t<u.length;t++)v[p++]=u[t];for(let t=0;t<h.length;t++)v[p++]=h[t];const g=new(a>65535?Uint32Array:Uint16Array)(3*(2*(i-1)+(a-2*i)));let d=0;for(let t=0;t<i-1;t++){const e=t+1;g[d++]=y-1-c[t],g[d++]=y-1-c[t]-1,g[d++]=f[t]+1+y,g[d++]=y-1-c[t],g[d++]=f[t]+1+y,g[d++]=f[t]+y,f[e]-f[t]==2?(g[d++]=f[t]+2+y,g[d++]=f[t]+1+y,g[d++]=y-c[e]-1):c[e]-c[t]==2&&(g[d++]=f[e]+y,g[d++]=y-1-(c[t]+1),g[d++]=y-1-(c[t]+2))}const b=n.bevelSize>0?I(v,[],n.bevelSize,null,!0):v,M=n.boundingRect;return{vertices:v,indices:g,topVertices:b,rect:{x:M.x*s[0]+l[0],y:M.y*s[1]+l[1],width:M.width*s[0],height:M.height*s[1]},depth:"function"==typeof n.depth?n.depth(e):n.depth,holes:[]}}function Q(t,e){const n=[];for(let r=0;r<t.length;r++){const i=t[r],o=[],l=i.length;let s=i[l-1][0],h=i[l-1][1],u=0;for(let t=0;t<l;t++){let n=i[t][0],r=i[t][1];const l=n-s,x=r-h;(u+=Math.sqrt(l*l+x*x))>e&&(o.push(i[t]),u=0),s=n,h=r}o.length>=3&&n.push(o)}return n.length>0?n:null}function T(t,n){n=Object.assign({},n);const r=[1/0,1/0],i=[-1/0,-1/0];for(let e=0;e<t.length;e++)Y(t[e][0],r,i);n.boundingRect=n.boundingRect||{x:r[0],y:r[1],width:i[0]-r[0],height:i[1]-r[1]},G(n);const o=[],l=n.translate||[0,0],s=n.scale||[1,1],h=n.boundingRect,u={x:h.x*s[0]+l[0],y:h.y*s[1]+l[1],width:h.width*s[0],height:h.height*s[1]},x=Math.min(h.width,h.height)/1e5;for(let r=0;r<t.length;r++){const i=Q(t[r],x);if(!i)continue;const{vertices:h,holes:c,dimensions:f}=e.flatten(i);for(let t=0;t<h.length;)h[t]=h[t++]*s[0]+l[0],h[t]=h[t++]*s[1]+l[1];if(D(h,c),2!==f)throw new Error("Only 2D polygon points are supported");const a=n.bevelSize>0?I(h,c,n.bevelSize,null,!0):h,v=U(a,c,f);o.push({indices:v,vertices:h,topVertices:a,holes:c,rect:u,depth:"function"==typeof n.depth?n.depth(r):n.depth})}return H(o,n)}function X(t,e){e=Object.assign({},e);const n=[1/0,1/0],r=[-1/0,-1/0];for(let e=0;e<t.length;e++)Y(t[e],n,r);e.boundingRect=e.boundingRect||{x:n[0],y:n[1],width:r[0]-n[0],height:r[1]-n[1]},G(e),null==e.lineWidth&&(e.lineWidth=1),null==e.miterLimit&&(e.miterLimit=2);const i=[];for(let n=0;n<t.length;n++)i.push(K(t[n],n,e));return H(i,e)}function Y(t,e,n){for(let r=0;r<t.length;r++)e[0]=Math.min(t[r][0],e[0]),e[1]=Math.min(t[r][1],e[1]),n[0]=Math.max(t[r][0],n[0]),n[1]=Math.max(t[r][1],n[1])}t.triangulate=U,t.flatten=function(t){return e.flatten(t)},t.offsetPolygon=I,t.extrudePolygon=T,t.extrudePolyline=X,t.extrudeGeoJSON=function(t,e){e=Object.assign({},e);const n=[],r=[],i=[],o=[],l=[1/0,1/0],s=[-1/0,-1/0];for(let e=0;e<t.features.length;e++){const h=t.features[e].geometry;if(h&&h.coordinates)switch(h.type){case"LineString":n.push(h.coordinates),i.push(e),Y(h.coordinates,l,s);break;case"MultiLineString":for(let t=0;t<h.coordinates.length;t++)n.push(h.coordinates[t]),i.push(e),Y(h.coordinates[t],l,s);break;case"Polygon":r.push(h.coordinates),o.push(e),Y(h.coordinates[0],l,s);break;case"MultiPolygon":for(let t=0;t<h.coordinates.length;t++)r.push(h.coordinates[t]),o.push(e),Y(h.coordinates[t][0],l,s)}}e.boundingRect=e.boundingRect||{x:l[0],y:l[1],width:s[0]-l[0],height:s[1]-l[1]};const h=e.depth;return{polyline:X(n,Object.assign(e,{depth:function(e){return"function"==typeof h?h(t.features[i[e]]):h}})),polygon:T(r,Object.assign(e,{depth:function(e){return"function"==typeof h?h(t.features[o[e]]):h}}))}},Object.defineProperty(t,"__esModule",{value:!0})});
